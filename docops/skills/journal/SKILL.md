---
name: journal
description: |
  Generate project JOURNAL.md from code evidence and project structure.
  Use when: creating project overview, documenting architecture, onboarding.
  Triggers: /docops:journal, generate journal, project overview, architecture doc.
argument-hint: "[output-path]"
allowed-tools: Read, Write, Glob, Grep, Bash
model: inherit
paths:
  - "**/.claude/docops.json"
  - "**/package.json"
  - "**/project-conveyor.md"
---

# DocOps Journal

Generate a comprehensive JOURNAL.md that documents the project structure and architecture.

## Purpose

Create a single-file project overview that:
- Documents the tech stack and dependencies
- Maps the directory structure
- Lists key components, APIs, and configurations
- Serves as onboarding documentation

## Workflow

### 1. Detect Project Type

Identify the project type by checking for:

| File/Dir | Project Type |
|----------|--------------|
| `nuxt.config.ts` | Nuxt application |
| `next.config.js` | Next.js application |
| `vite.config.ts` | Vite application |
| `angular.json` | Angular application |
| `server/` + `nitro` | Nitro/H3 API |
| `src/index.ts` + no framework | Node.js library |
| `plugin.json` | Claude Code plugin |

### 2. Extract Metadata

**From package.json:**
```bash
jq -r '.name, .version, .description' package.json
jq -r '.dependencies | keys[]' package.json
jq -r '.devDependencies | keys[]' package.json
```

**From project-conveyor.md (if exists):**
- Purpose (Section 1)
- Key Components (Section 4)
- Invariants (Section 6)

**From directory structure:**
```bash
find . -type d -maxdepth 2 -not -path '*/node_modules/*' -not -path '*/.git/*'
```

### 3. Generate Sections

The JOURNAL.md should contain:

```markdown
# {Project Name} - Architecture Overview

> Version: {version} | Generated: {date}

## Overview
{From project-conveyor.md Section 1, or package.json description}

## Tech Stack
{Extracted from dependencies}

## Directory Structure
{Tree view of main directories}

## Key Components
{From project-conveyor.md Section 4, or auto-detected}

## APIs / Routes
{Auto-detected from server/api/, pages/, etc.}

## Configuration
{List of config files found}

## Scripts
{From package.json scripts}

---
*Generated by DocOps Journal*
```

### 4. Output

Default output: `JOURNAL.md` in project root.
Custom output: Use argument `/docops:journal docs/JOURNAL.md`

## Project Type Templates

### Nuxt Application

```markdown
## Directory Structure
app/           # Frontend (pages, components, composables)
server/        # Backend (api, middleware, utils)
shared/        # Isomorphic code
public/        # Static assets

## Routes
{From pages/ directory}

## API Endpoints
{From server/api/ directory}

## Stores
{From stores/ or app/stores/}

## Composables
{From composables/ or app/composables/}
```

### Claude Code Plugin

```markdown
## Plugin Structure
.claude-plugin/plugin.json  # Manifest
agents/                     # Subagent definitions
commands/                   # Slash commands
skills/                     # Skills (SKILL.md)
hooks/hooks.json           # Hook configurations
scripts/                   # Bundled scripts

## Agents
{List from agents/*.md}

## Commands
{List from commands/*.md}

## Skills
{List from skills/*/SKILL.md}

## Hooks
{Events from hooks/hooks.json}
```

### Node.js Library

```markdown
## Structure
src/           # Source code
dist/          # Build output
tests/         # Test files

## Exports
{From package.json exports or main}

## Scripts
{From package.json scripts}
```

## Rules

1. **Evidence-based**: Only document what exists in code
2. **No guessing**: If unsure about purpose, mark as "TODO: describe"
3. **Link to conveyor**: Reference project-conveyor.md when available
4. **Keep updated**: JOURNAL.md should be regenerated on significant changes

## Examples

### Generate for current project
```
/docops:journal
```

### Generate to specific path
```
/docops:journal docs/architecture/JOURNAL.md
```

### Regenerate after changes
```
/docops:journal --force
```
